{
    "name": "partitions.sql",
    "tests": [
        {
            "query": "-- Make sure we can create an exclusion constraint\n-- across a partitioned table.\n-- That code looks at strategy numbers that can differ in regular gist vs btree_gist,\n-- so we want to make sure it works here too.\ncreate table parttmp (\n  id int,\n  valid_at daterange,\n  exclude using gist (id with =, valid_at with &&)\n) partition by range (id)",
            "name": "partitions.sql"
        },
        {
            "query": "create table parttmp_1_to_10 partition of parttmp for values from (1) to (10)",
            "name": "partitions.sql"
        },
        {
            "query": "create table parttmp_11_to_20 partition of parttmp for values from (11) to (20)",
            "name": "partitions.sql"
        },
        {
            "query": "insert into parttmp (id, valid_at) values\n  (1, '[2000-01-01, 2000-02-01)'),\n  (1, '[2000-02-01, 2000-03-01)'),\n  (2, '[2000-01-01, 2000-02-01)'),\n  (11, '[2000-01-01, 2000-02-01)'),\n  (11, '[2000-02-01, 2000-03-01)'),\n  (12, '[2000-01-01, 2000-02-01)')",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp_1_to_10 order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp_11_to_20 order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "update parttmp set valid_at = valid_at * '[2000-01-15,2000-02-15)' where id = 1",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp_1_to_10 order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "select * from parttmp_11_to_20 order by id, valid_at",
            "name": "partitions.sql"
        },
        {
            "query": "-- make sure the excluson constraint excludes:\ninsert into parttmp (id, valid_at) values\n  (2, '[2000-01-15, 2000-02-01)')",
            "name": "partitions.sql"
        },
        {
            "query": "drop table parttmp",
            "name": "partitions.sql"
        },
        {
            "query": "-- should fail with a good error message:\ncreate table parttmp (id int, valid_at daterange, exclude using gist (id with <>, valid_at with &&)) partition by range (id)",
            "name": "partitions.sql"
        }
    ]
}